"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=o.call(n)).done)&&(s.push(a.value),s.length!==t);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw r}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(d){!1!==window.hasOwnProperty("statikCommon")&&(window.statikCommon=window.statikCommon||{},window.statikCommon.instance={debug:parseInt(window.statikCommon.config.debug),$wrapper:d(document).find("#statik"),$multipleSelects:d(document).find("#statik select[data-multiple]"),$repeaters:d(document).find("#statik .js-repeater-wrapper"),$confirm:d(document).find("#statik .js-confirm-wrapper"),handleAsyncSelectsFields:function(){window.statikCommon.instance.$wrapper.find("select[data-async]").each(function(e,t){var n=d(t),a=n.data("current-value"),r=n.parent();d.ajax({url:n.data("async"),method:"GET",beforeSend:function(e){r.addClass("loading"),e.setRequestHeader("X-WP-Nonce",window.statikCommon.config.nonce)},error:function(e){return window.statikCommon.instance.debug&&console.log(e)},success:function(e){"object"===_typeof(e)&&e.forEach(function(e){e.value===a&&(e.selected=!0),n.append(d("<option>",e))}),n.attr("data-disabled")||n.removeAttr("disabled")},complete:function(){return r.removeClass("loading")}})})},handleMultipleSelects:function(){0!==window.statikCommon.instance.$multipleSelects.length&&(d("<link/>",{rel:"stylesheet",type:"text/css",href:"".concat(window.statikCommon.config.assetsUrl,"/stylesheets/vendors/selectize-0.12.6.min.css")}).appendTo("head"),d.getScript("".concat(window.statikCommon.config.assetsUrl,"/javascripts/vendors/jquery-ui-1.12.1.min.js"),function(){d.getScript("".concat(window.statikCommon.config.assetsUrl,"/javascripts/vendors/selectize-0.12.6.min.js"),function(){window.statikCommon.instance.$multipleSelects.each(function(e,t){var n=d(t).data("validation"),a=1===d(t).data("create");d(t).selectize({plugins:["remove_button","drag_drop"],delimiter:",",persist:!1,mode:"multi",create:a&&function(e){return!("string"==typeof n&&!RegExp(n).test(e))&&{value:e,text:e}}})})})}))},handleRepeaters:function(){0!==window.statikCommon.instance.$repeaters.length&&(window.statikCommon.instance.$repeaters.on("click",".js-add-row",function(e){e.preventDefault();var e=d(e.currentTarget).closest(".js-repeater-wrapper"),t=e.find(".js-fields-wrapper .js-repeater-row:last-of-type").data("key")||0;e.find(".js-fields-wrapper").append(e.find(".js-template").html().replace(/data-template-name/g,"name").replace(/data-template-required/g,"required").replace(/template-key/g,t+1))}),window.statikCommon.instance.$repeaters.on("click",".js-remove-row",function(e){e.preventDefault(),d(e.currentTarget).closest(".js-repeater-row").remove()}))},handleSettingsSelect:function(){window.statikCommon.instance.$wrapper.on("change","#nav-select",function(e){window.location.href=e.currentTarget.value})},handleConditionsFieldset:function(){function e(){var e=window.statikCommon.instance.$wrapper.find(".statik-grid-row[data-conditions]"),l=window.statikCommon.instance.$wrapper.find(".statik-generator[data-namespace]").data("namespace");e.each(function(e,t){for(var t=d(t),n=Object.entries(t.data("conditions")),a=[],r=0,o=n;r<o.length;r++){var i=_slicedToArray(o[r],2),s=i[0],i=i[1],c=void 0,c="!"===s.substring(s.length-1)&&(s=s.substring(0,s.length-1),!0),s=window.statikCommon.instance.$wrapper.find('[name="'.concat(l,"[").concat(s,']"]'));s.length&&(s.is(":checkbox")?a.push(c?s.is(":checked")!==!!i:s.is(":checked")===!!i):a.push(c?s.val()!==i:s.val()===i))}a.filter(function(e){return e}).length===n.length?(t.css("display","grid"),t.find("input, select, textarea").each(function(e,t){t=d(t);t.attr("required",t.attr("data-required")).removeAttr("data-required").attr("name",t.attr("data-name")).removeAttr("data-name")})):(t.css("display","none"),t.find("input, select, textarea").each(function(e,t){t=d(t);t.attr("data-required",t.attr("required")).removeAttr("required").attr("data-name",t.attr("name")).removeAttr("name")}))})}window.statikCommon.instance.$wrapper.on("change","form",e),e()},handleConfirm:function(){0!==window.statikCommon.instance.$confirm.length&&(d("<link/>",{rel:"stylesheet",type:"text/css",href:"".concat(window.statikCommon.config.assetsUrl,"/stylesheets/vendors/jquery-confirm-3.3.2.min.css")}).appendTo("head"),d.getScript("".concat(window.statikCommon.config.assetsUrl,"/javascripts/vendors/jquery-confirm-3.3.2.min.js")))}},window.statikCommon.instance.handleAsyncSelectsFields(),window.statikCommon.instance.handleMultipleSelects(),window.statikCommon.instance.handleRepeaters(),window.statikCommon.instance.handleSettingsSelect(),window.statikCommon.instance.handleConditionsFieldset(),window.statikCommon.instance.handleConfirm())}(window.jQuery);